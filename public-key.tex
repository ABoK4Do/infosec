\chapter{Криптосистемы с открытым ключом}\label{chapter-public-key}
\selectlanguage{russian}

\textbf{Криптосистемой с открытым ключом} (public-key cryptosystem, PKC) называется криптографическое преобразование, использующее два ключа -- открытый и секретный. Пара из \textbf{секретного}\index{ключ!секретный} (private key, secret key, SK) и \textbf{открытого}\index{ключ!открытый} (public key, PK) ключей создается пользователем, который свой секретный ключ держит в секрете, а открытый ключ делает общедоступным для всех пользователей. Криптографическое преобразование в одну сторону (шифрование) можно выполнить зная только открытый ключ, а в другую (расшифрование) -- только зная секретный ключ. Во многих криптосистемах из секретного ключа можно вычислить открытый ключ.

Если прямое преобразование выполняется открытым ключом, а обратное -- секретным, то криптосистема называется схемой \textbf{шифрования с открытым ключом}. Все пользователи, зная открытый ключ получателя, могут зашифровать для него сообщение, которое может расшифровать только владелец секретного ключа.

Если прямое преобразование выполняется секретным ключом, а обратное -- открытым, то криптосистема называется схемой \textbf{электронной подписи (ЭП)}, -- владелец секретного ключа может \emph{подписать} (зашифровать) сообщение, а все пользователи, зная открытый ключ, могут проверить, что подпись (шифротекст) была создана только владельцем секретного ключа и никем другим.

Некоторые криптосистемы с открытым ключом могут использоваться и как схема шифрования, и как схема ЭП с одним алгоритмом, например криптосистема RSA\index{криптосистема!RSA}. В общем случае это не так. Например, есть криптосистема с открытым ключом Эль-Гамаля\index{криптосистема!Эль-Гамаля} и другой алгоритм -- схема ЭП Эль-Гамаля\index{криптосистема!Эль-Гамаля}.

Для более простого опубликования открытых ключей производители операционных систем, браузеров и программных продуктов часто встраивают наборы открытых ключей различных организаций. Браузеры и операционные системы содержат десятки-сотни встроенных открытых ключей, принадлежащих центрам выдачи сертификатов X.509, производителям программных продуктов, банковским и интернет-сервисам. Фактически все пользователи \textbf{доверяют}\index{доверие} производителям ПО и тому, что открытые ключи, встроенные в продукт, действительно принадлежат их истинным владельцам.

Криптосистемы с открытым ключом построены на основе односторонних (однонаправленных) функций c потайным входом. Под \textbf{односторонней} функцией понимают \emph{вычислительную} невозможность вычисления ее обращения: вычисление значения функции $y = f(x)$ при заданном аргументе $x$ является легкой задачей, вычисление аргумента $x$ при заданном значении функции $y$ -- трудной задачей.

Рассмотрим, например, умножение больших целых чисел $p,q$, каждое из которых состоит из 500 бит в двоичной записи. Как известно, вычисление их произведения является легкой задачей, сложность которой по порядку не превышает $500^2$ битовых операций. Однако обратная задача -- разложить 1000-битовое число $n=pq$, представляющее собой произведение двух простых 500-битовых чисел, на простые множители является трудной задачей, связанной с поиском делителей, сложность которой оценивается экспонентой от корня квадратного длины числа ($ \exp(1000^1/2)$).

Односторонняя функция $y = f(x,K)$ с \textbf{потайным входом}\index{функция!с потайным входом} $K$ определяется как функция, которая легко вычисляется при заданном $x$, и аргумент $x$ которой можно легко вычислить из $y$, если известен <<секретный>> параметр $K$, и вычислить невозможно, если параметр $K$ неизвестен.

Криптосистемы с открытым ключом построены на дискретной математике. Необходимые математические основы модульной арифметики, групп, полей и простых чисел приведены в Приложении \ref{chap:discrete-math}.

\input{rsa}

\input{el-gamal}

\input{GOST_R_34.10-2001.tex}

\input{pki_key_length}